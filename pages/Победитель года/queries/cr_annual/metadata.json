{
  "pluginType": "DB",
  "pluginId": "mysql-plugin",
  "unpublishedAction": {
    "name": "cr_annual",
    "datasource": {
      "name": "contest",
      "pluginId": "mysql-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "contest",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "Победитель года",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "SELECT\n\trow_number() over (\n\t\torder by \n\t\t\tca.sum_annual_points desc\n\t\t\t, ca.best_place asc\n\t\t\t, ca.best_place_count desc\n\t\t\t, ca.second_best_place asc\n\t\t\t, ca.second_best_place_count desc\n\t\t\t, ca.third_best_place asc \n\t\t\t, ca.avg_roi desc\n    ) AS `place`\n\t, un.nickname\n\t, (\n\t\tSELECT \n\t\t\tcg.annual_points\n\t\tfrom cr_general cg\n\t\twhere 1=1\n\t\t\tand cg.contest_id = (\n\t\t\t\tSELECT \n\t\t\t\t\tc2.id \n\t\t\t\tfrom annual_x_seasonal_contest axsc \n\t\t\t\t\tjoin contest c1 on c1.id = axsc.annual_contest_id \n\t\t\t\t\tjoin contest c2 on c2.id = axsc.seasonal_contest_id \n\t\t\t\twhere 1=1\n\t\t\t\t\tand c1.`type` = 'annual'\n\t\t\t\t\tand c1.`year` = c.`year` \n\t\t\t\t\tand c2.`type` = 'seasonal'\n\t\t\t\t\tand c2.season = 'Autumn'\n\t\t\t)\n\t\t\tand cg.user_id = un.user_id \n\t) as autumn\n\t, (\n\t\tSELECT \n\t\t\tcg.annual_points\n\t\tfrom cr_general cg\n\t\twhere 1=1\n\t\t\tand cg.contest_id = (\n\t\t\t\tSELECT \n\t\t\t\t\tc2.id \n\t\t\t\tfrom annual_x_seasonal_contest axsc \n\t\t\t\t\tjoin contest c1 on c1.id = axsc.annual_contest_id \n\t\t\t\t\tjoin contest c2 on c2.id = axsc.seasonal_contest_id \n\t\t\t\twhere 1=1\n\t\t\t\t\tand c1.`type` = 'annual'\n\t\t\t\t\tand c1.`year` = c.`year` \n\t\t\t\t\tand c2.`type` = 'seasonal'\n\t\t\t\t\tand c2.season = 'Winter'\n\t\t\t)\n\t\t\tand cg.user_id = un.user_id \n\t) as winter\n\t, (\n\t\tSELECT \n\t\t\tcg.annual_points\n\t\tfrom cr_general cg\n\t\twhere 1=1\n\t\t\tand cg.contest_id = (\n\t\t\t\tSELECT \n\t\t\t\t\tc2.id \n\t\t\t\tfrom annual_x_seasonal_contest axsc \n\t\t\t\t\tjoin contest c1 on c1.id = axsc.annual_contest_id \n\t\t\t\t\tjoin contest c2 on c2.id = axsc.seasonal_contest_id \n\t\t\t\twhere 1=1\n\t\t\t\t\tand c1.`type` = 'annual'\n\t\t\t\t\tand c1.`year` = c.`year` \n\t\t\t\t\tand c2.`type` = 'seasonal'\n\t\t\t\t\tand c2.season = 'Spring'\n\t\t\t)\n\t\t\tand cg.user_id = un.user_id \n\t) as spring\n\t, ca.avg_roi\n\t, ca.sum_annual_points as points\nfrom user_nickname un\n\tjoin cr_annual ca on ca.user_id = un.user_id\n\tjoin contest c on c.id = ca.contest_id\nwhere 1=1\n\tand un.is_active = 1\n\tand c.`type` = 'annual'\n\tand c.`year` = {{Select_contest.selectedOptionValue}}\n;",
      "selfReferencingDataPaths": [],
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ]
    },
    "executeOnLoad": true,
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [
      "Select_contest.selectedOptionValue"
    ],
    "userSetOnLoad": false,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": [],
    "createdAt": "2024-05-19T15:39:34Z"
  },
  "id": "Победитель года_cr_annual",
  "deleted": false,
  "gitSyncId": "661eca10b7e3352fe43e8a8c_fddb12a1-d035-4816-a887-ef17dc889529"
}