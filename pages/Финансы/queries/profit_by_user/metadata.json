{
  "gitSyncId": "661eca10b7e3352fe43e8a8c_1444e582-d8d1-4385-afbc-193c9a6e306a",
  "id": "Финансы_profit_by_user",
  "pluginId": "mysql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT \n\t(\n\t\trow_number() over(\n\t\t\torder by \n\t\t\t\tt1.total desc\n\t\t)\n\t) as place\n\t, t1.nickname\n\t, t1.awards\n\t, t1.fees\n\t, t1.total\nfrom (\n\tselect\n\t\tun.nickname \n\t\t, sum(\n\t\t\tCASE \n\t\t\t\twhen cf.action_value > 0 then cf.action_value else 0 \n\t\t\tEND\n\t\t) as awards\n\t\t, sum(\n\t\t\tCASE \n\t\t\t\twhen cf.action_value < 0 then cf.action_value else 0 \n\t\t\tEND\n\t\t) as fees\n\t\t, SUM(cf.action_value) as total \n\tfrom cr_finance cf \n\t\tjoin user_nickname un on un.user_id = cf.user_id \n\twhere 1=1\n\t\tand un.is_active = 1\n\t\tand un.nickname not in ('DavidsKV', 'Dnepr', 'JovtoBlakutni', 'Sayda', 'Ars', 'BeTeLGeuSe')\n\t\tand cf.contest_id not in (\n\t\t\t\tSELECT \n\t\t\t\t\tid\n\t\t\t\tfrom contest c \n\t\t\t\twhere c.`type` = 'seasonal'\n\t\t\t\tand c.is_active = 1\n\t\t\t)\n\t\t\tand cf.contest_id not in (\n\t\t\t\tSELECT \n\t\t\t\t\tsxmc.monthly_contest_id\n\t\t\t\tfrom seasonal_x_monthly_contest sxmc\n\t\t\t\t\tjoin contest c2 on c2.id = sxmc.seasonal_contest_id\n\t\t\t\twhere c2.`type` = 'seasonal'\n\t\t\t\t\tand c2.is_active = 1 \n\t\t\t)\n\tGROUP by cf.user_id \n) t1;",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "contest",
      "isAutoGenerated": false,
      "name": "contest",
      "pluginId": "mysql-plugin"
    },
    "dynamicBindingPathList": [],
    "executeOnLoad": true,
    "name": "profit_by_user",
    "pageId": "Финансы",
    "userSetOnLoad": false
  }
}